# CoreSight_L2_Decoder设计
注：所有输入以最右为低位，根据L1的实现，数据可以有四个周期的时钟进行处理
## 组件1：PreProceessor

1. 输入

| 端口名      | 宽度 | 描述 |
| :----: | :---: | :-----------------: |
| trace_clk      | 1     | 全局时钟     |
| in_data   | 240       | 输入的ID_Data，为15x(8+8)的形式低8位为ID，高8位为Data |
| in_data_valid | 1 |输入数据可用 |
| in_ID | 8 | 当前L2_Decoder所属的PE的ID |

2. 输出

| 端口名      | 宽度 | 描述 |
| :----: | :---: | :-----------------: |
| out_cnt      | 4     | 输出的数据中可用的数据数量 |
| out_R   | 120       | 输出的数据，为8x(0-15), 可用的数据量由out_cnt指定 |
| PP_out_valid | 1 |输出数据可用 |

3. 用途

将输入的15个ID_Data进行过滤，得到其中符合当前L2_Decoder ID的数据，输出若干（0-15）纯数据序列。
输入的ID_Data存在两种形式，其一为DATA:ID，其二为ID:FF，后者为废弃数据，会被直接抛弃。

输出模式：在in_data_valid上升的同周期out_cnt上升，下一个时钟周期PP_out_valid上升，out_R产生数据。总体需要的时钟为2时钟周期。

### 子组件1-1：Index_Formatter

1. 输入

| 端口名      | 宽度 | 描述 |
| :----: | :---: | :-----------------: |
| IF_i_data_valid     | 1     | 第i个数据是否是合法数据     |
| count   | 15       |  低i位表示前i数据是否合法，高位用0填充 |

2. 输出

| 端口名      | 宽度 | 描述 |
| :----: | :---: | :-----------------: |
| IF_o_data     | 4  | 计算出的合法数据存储的位置序数 |

3. 用途

根据输入的数据合法情况计算出每个数据在最终输出的位置序号